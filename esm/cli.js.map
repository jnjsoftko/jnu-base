{"version":3,"sources":["../src/cli.ts"],"sourcesContent":["import { execSync, ExecSyncOptionsWithStringEncoding } from 'child_process';\nimport Path from 'path';\nimport { sleep } from './basic.js';\nimport {\n  composeHangul,\n  makeDir,\n  copyDir,\n  loadJson,\n  saveJson,\n  loadFile,\n  saveFile,\n  findFiles,\n  deleteFilesInFolder,\n  renameFilesInFolder,\n  substituteInFile,\n} from './builtin.js';\nimport { findGithubAccount } from './git.js';\nimport type { ExecResult, ExecResults, CliOptions } from './types.js';\n\n// & Variables AREA\n// &---------------------------------------------------------------------------\nconst TEMPLATES_ROOT = `${process.env.DEV_CONFIG_ROOT}/Templates` ?? 'C:/JnJ-soft/Developments/Templates';\nconst PLATFORM =\n  process.platform === 'win32'\n    ? 'win'\n    : process.platform === 'darwin'\n    ? 'mac'\n    : process.platform === 'linux'\n    ? 'linux'\n    : process.platform;\n\n// Windows 실행 옵션에 코드페이지 변경 명령 추가\nconst execOptions: ExecSyncOptionsWithStringEncoding = {\n  encoding: 'utf8',\n  shell:\n    process.platform === 'win32'\n      ? 'cmd.exe /d /s /c chcp 65001>nul &&' // UTF-8 코드페이지 설정\n      : '/bin/sh',\n};\n\n// & Functions AREA\n// &---------------------------------------------------------------------------\n\n// * Command Execution Functions\n/**\n * 단일 명령어 실행\n * @param cmd 실행할 명령어\n * @returns 명령어 실행 결과\n *\n * @example\n * ```ts\n * exec('ls -la') // 디렉토리 목록 출력\n * exec('echo \"Hello\"') // 'Hello'\n * exec('pwd') // 현재 작업 디렉토리 경로\n * ```\n */\nconst exec = (cmd: string): ExecResult => {\n  const result = execSync(cmd, { encoding: 'utf8' });\n  return result ? result.toString().trim() : '';\n};\n\n/**\n * 여러 명령어 순차 실행\n * @param cmds 실행할 명령어 배열\n * @returns 각 명령어의 실행 결과 배열\n *\n * @example\n * ```ts\n * exe(['pwd', 'ls -la']) // [현재 경로, 디렉토리 목록]\n * exe(['echo \"Hello\"', 'echo \"World\"']) // ['Hello', 'World']\n * ```\n */\nconst exe = (cmds: string[]): ExecResults => {\n  const results: string[] = [];\n  cmds.forEach((cmd) => results.push(exec(cmd)));\n  return results;\n};\n\n/**\n * 현재 디렉토리 경로 반환\n */\nconst getCurrentDir = (): string => {\n  switch (PLATFORM) {\n    case 'win':\n      return execSync('cd', execOptions).toString().trim().replace(/\\\\/g, '/');\n    default:\n      return execSync('pwd', execOptions).toString().trim();\n  }\n};\n\n/**\n * 현재 디렉토리의 부모 디렉토리 경로 반환\n */\nconst getParentDir = (): string => {\n  switch (PLATFORM) {\n    case 'win':\n      return Path.dirname(execSync('cd', execOptions).toString().trim().replace(/\\\\/g, '/'));\n    default:\n      return Path.dirname(execSync('pwd', execOptions).toString().trim());\n  }\n};\n\n\n// * Main Functions\n// &---------------------------------------------------------------------------\n/**\n * TypeScript + SWC + NPM 프로젝트 초기화\n */\nconst initTsSwcNpm = (options: CliOptions) => {\n  const account = findGithubAccount(options.userName ?? '');\n  const parentDir = getParentDir();\n  const currentDir = getCurrentDir();\n\n  let cmd = '';\n\n  if (PLATFORM === 'win') {\n    cmd = `xcopy \"${TEMPLATES_ROOT}\\\\ts-swc-npm\" \"${options.repoName}\\\\\" /E /I /H /Y`;\n    execSync(cmd, execOptions);\n  } else {\n    cmd = `cp -r ${TEMPLATES_ROOT}/ts-swc-npm ${options.repoName}`;\n    execSync(cmd, execOptions);\n  }\n\n  substituteInFile(`${options.repoName}/package.json`, {\n    '{{name}}': options.repoName ?? '',\n    '{{author}}': `${account.fullName} <${account.email}>`,\n    '{{description}}': options.description ?? '',\n  });\n\n  substituteInFile(`${options.repoName}/README.md`, {\n    '{{name}}': options.repoName ?? '',\n    '{{project-name}}': options.repoName ?? '',\n    '{{author}}': `${account.fullName} <${account.email}>`,\n    '{{github-id}}': options.userName ?? '',\n    '{{description}}': options.description || '',\n    '{{parent-dir}}': parentDir,\n    '{{current-dir}}': currentDir,\n  });\n\n  substituteInFile(`${options.repoName}/docs/workflow.md`, {\n    '{{name}}': options.repoName ?? '',\n    '{{project-name}}': options.repoName ?? '',\n    '{{github-id}}': options.userName ?? '',\n    '{{description}}': options.description || '',\n    '{{parent-dir}}': parentDir,\n    '{{current-dir}}': currentDir,\n  });\n\n  cmd = `cd ${currentDir}/${options.repoName} && npm install`;\n  console.log(cmd);\n  execSync(cmd, execOptions);\n  cmd = `cd ${currentDir}/${options.repoName} && xgit -e makeRepo -u ${options.userName} -n ${options.repoName} -d \"${options.description}\"`;\n  console.log(cmd);\n  execSync(cmd, execOptions);\n};\n\n/**\n * 앱 제거 (로컬 + 원격 저장소)\n */\nconst removeApp = (options: CliOptions) => {\n  execSync(`xgit -e deleteRemoteRepo -u ${options.userName} -n ${options.repoName}`, execOptions);\n  if (PLATFORM === 'win') {\n    execSync(`rmdir /s /q ${options.repoName}`, execOptions);\n  } else {\n    execSync(`rm -rf ${options.repoName}`, execOptions);\n  }\n};\n\n/**\n * 템플릿 기반 앱 초기화\n */\nconst initApp = (options: CliOptions) => {\n  switch (options.template) {\n    case 'node-simple':\n      break;\n    case 'ts-swc-npm':\n      initTsSwcNpm(options);\n      break;\n    case 'python-pipenv':\n      break;\n    case 'flutter':\n      break;\n  }\n};\n\n// /**\n//  * 폴더, 파일 삭제\n//  */\n// const del = (options: CliOptions) => {\n//   if (PLATFORM === 'win') {\n//     execSync(`rmdir /s /q ${options.repoName}`, execOptions);\n//   } else {\n//     execSync(`rm -rf ${options.repoName}`, execOptions);\n//   }\n// };\n\n\n/**\n * 폴더, 파일 삭제\n */\nconst del = (options: CliOptions) => {\n  deleteFilesInFolder(options.repoName ?? '', options.excluded ?? '', true);\n};\n\n/**\n * 로컬 프로젝트 압축\n */\nconst zip = (options: CliOptions) => {\n  switch (PLATFORM) {\n    case 'win':\n      try {\n        // 1. 임시 디렉토리 생성\n        const tempDir = `${options.repoName}_temp`;\n        execSync(`xcopy \"${options.repoName}\" \"${tempDir}\\\\\" /E /I /H /Y`, execOptions);\n\n        // 2. 제외할 파일/폴더 삭제\n        const excludedItems = options.excluded\n          ? options.excluded.split(',')\n          : ['node_modules', 'package-lock.json', 'package.json'];\n\n        for (const item of excludedItems) {\n          const itemPath = `${tempDir}/${item}`;\n          try {\n            if (item.includes('/')) {\n              execSync(`rmdir /s /q \"${itemPath}\"`, execOptions);\n            } else {\n              execSync(`del /q \"${itemPath}\"`, execOptions);\n            }\n          } catch (err) {\n            console.log(`Warning: Could not remove ${item}`);\n          }\n        }\n\n        // 3. 압축\n        execSync(\n          `powershell -Command \"Compress-Archive -Path ${tempDir}/* -DestinationPath ${options.repoName}.zip -Force\"`,\n          execOptions\n        );\n\n        // 4. 임시 디렉토리 삭제\n        execSync(`rmdir /s /q \"${tempDir}\"`, execOptions);\n      } catch (error) {\n        console.error('Error during zip operation:', error);\n        throw error;\n      }\n      break;\n\n    default:\n      const excluded = options.excluded\n        ? options.excluded\n            .split(',')\n            .map((item) => `\"${item}\"`)\n            .join(' ')\n        : '\"*/node_modules/*\" \".git/*\"';\n      execSync(`zip -r ${options.repoName}.zip ${options.repoName} -x ${excluded}`, execOptions);\n      break;\n  }\n};\n\n/**\n * 디렉토리 내에 있는 모든 압축 파일 해제(zip 파일 이름의 폴더에 압축 해제)\n * @param folderPath 압축 파일이 있는 폴더 경로\n * @example\n * ```ts\n * // 현재 폴더의 모든 zip 파일을 압축 해제\n * unzip('./');\n * ```\n */\nconst unzip = (folderPath: string): string => {\n  // 각 zip 파일에 대해 처리\n  const currentDir = getCurrentDir();\n  const extractPaths: string[] = [];\n  for (const zipPath of findFiles(folderPath, '*.zip')) {\n    try {\n      const extractPath = `${currentDir}/_unzip/${Path.parse(zipPath).name}`;\n      makeDir(extractPath);\n\n      // 운영체제에 따른 명령어 설정\n      let command: string;\n      if (process.platform === 'win32') {\n        // Windows\n        command = `powershell -command \"Expand-Archive -Path '${zipPath}' -DestinationPath '${extractPath}' -Force\"`;\n      } else {\n        // macOS, Linux\n        command = `unzip -o \"${zipPath}\" -d \"${extractPath}\"`;\n      }\n\n      // 압축 해제 실행\n      execSync(command);\n      console.log(`압축 해제 완료: ${zipPath} -> ${extractPath}`);\n      extractPaths.push(extractPath);\n    } catch (err: any) {\n      console.error(`'${zipPath}' 압축 해제 중 오류 발생:`, err.message);\n    }\n  }\n  return extractPaths.join(',');\n};\n\n  // try {\n  //   // 폴더가 존재하지 않으면 종료\n  //   if (!fs.existsSync(folderPath)) {\n  //     console.error(`폴더가 존재하지 않습니다: ${folderPath}`);\n  //     return;\n  //   }\n\n  //   // zip 파일 찾기\n  //   const files = fs.readdirSync(folderPath);\n  //   const zipFiles = files.filter(file => file.toLowerCase().endsWith('.zip'));\n\n  //   if (zipFiles.length === 0) {\n  //     console.log('압축 파일이 없습니다.');\n  //     return;\n  //   }\n\n  //   // 각 zip 파일에 대해 처리\n  //   for (const zipFile of zipFiles) {\n  //     try {\n  //       const zipPath = Path.join(folderPath, zipFile);\n  //       const extractPath = Path.join(folderPath, Path.parse(zipFile).name);\n\n  //       // 압축 해제할 폴더 생성\n  //       if (!fs.existsSync(extractPath)) {\n  //         fs.mkdirSync(extractPath, { recursive: true });\n  //       }\n\n  //       // 운영체제에 따른 명령어 설정\n  //       let command: string;\n  //       if (process.platform === 'win32') {\n  //         // Windows\n  //         command = `powershell -command \"Expand-Archive -Path '${zipPath}' -DestinationPath '${extractPath}' -Force\"`;\n  //       } else {\n  //         // macOS, Linux\n  //         command = `unzip -o \"${zipPath}\" -d \"${extractPath}\"`;\n  //       }\n\n  //       // 압축 해제 실행\n  //       execSync(command);\n  //       console.log(`압축 해제 완료: ${zipFile} -> ${Path.parse(zipFile).name}`);\n\n  //     } catch (err: any) {\n  //       console.error(`'${zipFile}' 압축 해제 중 오류 발생:`, err.message);\n  //     }\n  //   }\n  // } catch (err: any) {\n  //   console.error('압축 해제 중 오류 발생:', err.message);\n  // }\n\n\n/**\n * 프로젝트 구조 분석\n */\nconst tree = (options: CliOptions): string => {\n  switch (PLATFORM) {\n    case 'win':\n      const excludedWin = options.excluded\n        ? options.excluded.split(',').join('|')\n        : 'node_modules|dist|_backups|_drafts|types|docs';\n\n      try {\n        // PowerShell 실행 정책 우회 및 단순화된 명령어\n        const cmd = `powershell -NoProfile -ExecutionPolicy Bypass -Command \"$OutputEncoding = [Console]::OutputEncoding = [Text.Encoding]::UTF8; tree /F /A | Select-String -NotMatch '${excludedWin}'\"`;\n        console.log('Command: ', cmd);\n\n        const result = execSync(cmd, {\n          encoding: 'utf8',\n          stdio: 'pipe',\n        });\n\n        console.log('Result: ', result);\n        if (result) {\n          saveFile('tree.txt', result, { overwrite: true, newFile: false, encoding: 'utf8' });\n        }\n\n        return result || '';\n      } catch (error) {\n        console.error('Error executing tree command:', error);\n        return '';\n      }\n\n    default:\n      const excluded = options.excluded\n        ? `\"${options.excluded.split(',').join('|')}\"`\n        : '\"node_modules|dist|_backups|_drafts|types|docs\"';\n\n      const cmd = `tree -I ${excluded} --dirsfirst -L 3`;\n      try {\n        console.log('Command: ', cmd);\n        const result = execSync(cmd, {\n          encoding: 'utf8',\n          stdio: 'pipe',\n        });\n\n        if (result) {\n          saveFile('tree.txt', result, { overwrite: true, newFile: false });\n        }\n\n        return result || '';\n      } catch (error) {\n        console.error('Error executing tree command:', error);\n        return '';\n      }\n  }\n};\n\n// & Export AREA\n// &---------------------------------------------------------------------------\nexport { TEMPLATES_ROOT, PLATFORM, exec, exe, execOptions, getParentDir, getCurrentDir, initApp, removeApp, zip, tree, del, unzip };\n\n// & Test AREA\n// &---------------------------------------------------------------------------\n// console.log(exec(\"dir /w\"));\n// console.log(exec(\"powershell -Command \\\"Get-ChildItem | Format-Wide\\\"\"));\n"],"names":["execSync","Path","makeDir","saveFile","findFiles","deleteFilesInFolder","substituteInFile","findGithubAccount","TEMPLATES_ROOT","process","env","DEV_CONFIG_ROOT","PLATFORM","platform","execOptions","encoding","shell","exec","cmd","result","toString","trim","exe","cmds","results","forEach","push","getCurrentDir","replace","getParentDir","dirname","initTsSwcNpm","options","account","userName","parentDir","currentDir","repoName","fullName","email","description","console","log","removeApp","initApp","template","del","excluded","zip","tempDir","excludedItems","split","item","itemPath","includes","err","error","map","join","unzip","folderPath","extractPaths","zipPath","extractPath","parse","name","command","message","tree","excludedWin","stdio","overwrite","newFile"],"mappings":"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"}